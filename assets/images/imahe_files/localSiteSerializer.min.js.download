define("localSiteSerializer",["lodash","coreUtils","utils"],function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1481)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},10:function(e,t){e.exports=n},1481:function(e,t,n){var r,a;r=[n(0),n(1482),n(1490)],void 0===(a=function(e,t,n){"use strict";return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.plugins,i=void 0===a?Object.values(t):a,o=r.encodeWhenSerializing,s=void 0===o||o,u=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.encode,a=e.cloneDeep(t);return i.reduce(function(n,i){return i.getEncryptedPaths(a).forEach(function(a){var i=e.get(t,a);i&&e.set(n,a,r(i))}),n},a)},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.decode;return u(e,t)};return{serialize:function(t){var n=i.reduce(function(n,r){var a=r.serialize;return e.merge(n,a(t))},{});return s?u(n):n},deserialize:function(t){var n=s?c(t):t;return i.reduce(function(t,r){var a=r.deserialize;return e.merge(t,a(n))},{})},encode:u,decode:c}}}.apply(t,r))||(e.exports=a)},1482:function(e,t,n){var r,a;r=[n(0),n(1483),n(1484),n(1485),n(1486),n(1487),n(1488),n(1489)],void 0===(a=function(e,t,n,r,a,i,o,s){"use strict";return{styles:t,commonComponents:n,pages:r,menu:s,background:o,routers:i,siteInfo:a}}.apply(t,r))||(e.exports=a)},1483:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.pagesData.masterPage.data.theme_data;return{styles:{colors:n.THEME_DATA.color,fonts:n.THEME_DATA.font,theme:e.omit(n.THEME_DATA,"color","font"),topLevelStyles:e.omit(n,"THEME_DATA")}}},deserialize:function(e){var t=e.styles;return{pagesData:{masterPage:{data:{theme_data:Object.assign({THEME_DATA:Object.assign({color:t.colors,font:t.fonts},t.theme)},t.topLevelStyles)}}}}},getEncryptedPaths:function(){return["styles.colors","styles.fonts","styles.theme","styles.topLevelStyles"]}}}.apply(t,r))||(e.exports=a)},1484:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n,r,a,i,o=t.pagesData;return{site:{commonComponents:(n=o.masterPage.structure,r=e.findIndex(n.children,{id:"PAGES_CONTAINER"}),a=e.findIndex(n.children,{id:"SITE_FOOTER"}),i=e.get(n,"children["+r+"].layout.y"),e.set(n,"children["+r+"].layout.height",400),e.set(n,"children["+a+"].layout.y",400+i),n)}}},deserialize:function(e){return{pagesData:{masterPage:{structure:e.site.commonComponents}}}},getEncryptedPaths:function(){return["site.commonComponents"]}}}.apply(t,r))||(e.exports=a)},1485:function(e,t,n){var r,a;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";var t=function(e,t){return e?i({},t,e):{}};return{serialize:function(n){var r=n.pagesData,a=n.rendererModel;return{pages:Object.keys(r).filter(function(e){return"masterPage"!==e}).reduce(function(n,i){var o=r.masterPage.data.document_data[i],s=o.pageUriSEO,u=o.title,c=o.isPopup,d=o.id;return e.unset(r.masterPage.data.document_data[i],"pageUriSEO"),e.unset(r.masterPage.data.document_data[i],"title"),n[i]={pageUriSeo:s,title:u,isPopUp:c,pageId:d,content:Object.assign({},r[i],t(e.get(a.pagesPlatformApplications,i),"pagesPlatformApplications"),t(a.passwordProtectedPages&&a.passwordProtectedPages.find(function(e){return e===i}),"passwordProtectedPages"))},n},{})}},deserialize:function(t){return{pagesData:Object.keys(t.pages).filter(function(e){return"masterPage"!==e}).reduce(function(n,r){var a;return Object.assign(n,(i(a={},r,Object.assign(t.pages[r].content,{title:t.pages[r].title,isPopup:t.pages[r].isPopUp})),i(a,"masterPage",e.merge(n.masterPage,{data:{document_data:i({},r,{isPopup:t.pages[r].isPopUp,title:t.pages[r].title,pageUriSEO:t.pages[r].pageUriSeo,id:t.pages[r].pageId})}})),a))},{}),rendererModel:Object.keys(t.pages).filter(function(e){return"masterPage"!==e}).reduce(function(e,n){var r=t.pages[n].content;return r.pagesPlatformApplications&&(e.pagesPlatformApplications[n]=r.pagesPlatformApplications),delete r.pagesPlatformApplications,e.passwordProtectedPages=e.passwordProtectedPages.concat(r.passwordProtectedPages?r.passwordProtectedPages:[]),delete r.passwordProtectedPages,e},{pagesPlatformApplications:{},passwordProtectedPages:[]})}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages."+e+".content"})}}}.apply(t,r))||(e.exports=a)},1486:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.pagesData,r=t.documentServicesModel,a=t.rendererModel,i=n.masterPage;return{site:Object.assign({},{siteInfo:a.siteInfo,version:{version:r.version,revision:r.revision},dataFromMasterPage:e.omit(i,"structure","data.theme_data")},a.multilingualInfo?{multilingualInfo:a.multilingualInfo}:{})}},deserialize:function(e){return{pagesData:{masterPage:e.site.dataFromMasterPage},documentServicesModel:Object.assign(e.site.version),rendererModel:Object.assign({siteInfo:e.site.siteInfo},e.site.multilingualInfo?{multilingualInfo:e.site.multilingualInfo}:{})}},getEncryptedPaths:function(){return["site.siteInfo","site.revision","site.version","site.dataFromMasterPage","site.multilingualInfo"]}}}.apply(t,r))||(e.exports=a)},1487:function(e,t,n){var r,a;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";return{serialize:function(t){var n=t.rendererModel,r=e.get(n,"routers.configMap",{});return{routers:Object.keys(r).reduce(function(e,t){return Object.assign(e,i({},r[t].prefix,Object.assign({},r[t],{routeId:t})))},{})}},deserialize:function(t){return{rendererModel:{routers:{configMap:Object.keys(t.routers).reduce(function(n,r){return e.merge(n,i({},t.routers[r].routeId,Object.assign({},e.omit(t.routers[r],"routeId"),{prefix:r})))},{})}}}},getEncryptedPaths:function(e){return Object.keys(e.routers).map(function(e){return"routers."+e})}}}.apply(t,r))||(e.exports=a)},1488:function(e,t,n){var r,a;r=[n(0),n(10),n(1)],void 0===(a=function(e,t,n){"use strict";var r=t.siteUtils,a=function(t,n,a){return r.getPageBackgroundDataPointers(a,[n]).reduce(function(t,n){var r=n.path;return e.get(a,r)&&(e.set(t,r,e.get(a,r)),e.unset(a,r)),t},{})},i=function(t,n,a){return r.getPageBackgroundDataPointers(n.content,[a]).forEach(function(r){var a=r.path;e.set(t,a,e.get(n.content,a)),e.unset(n.content,a)}),t};return{serialize:function(t){var r=t.pagesData,i=r[n.siteConstants.MASTER_PAGE_ID];return{pages:e(r).omit("masterPage").mapValues(function(e,t){return{content:a(0,t,i)}}).value()}},deserialize:function(t){var n=t.pages;return{pagesData:{masterPage:e(n).omit("masterPage").reduce(i,{data:{document_data:{}}})}}},getEncryptedPaths:function(e){return Object.keys(e.pages).map(function(e){return"pages."+e+".content"})}}}.apply(t,r))||(e.exports=a)},1489:function(e,t,n){var r,a;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}r=[n(0)],void 0===(a=function(e){"use strict";var t=["PageLink","AnchorLink"],n=function(e){return e.replace(/^#/,"")};return{serialize:function(r){var a=r.pagesData,i=a.masterPage.data.document_data,o=function(t){return e(t).mapValues().filter(["type","CustomMenusCollection"]).flatMap("menus").map(n).value()}(i);return e.reduce(o,function(r,o){var s=function(t,r){return e.flattenDeep(function r(a){var i=a.dataId,o=a.parent,s=void 0===o?null:o,u=a.index,c=void 0===u?0:u,d="data.document_data."+i.replace("#",""),p=[],l=e.get(t,d+".items");return l.length>0&&p.push(l.map(function(e,t){return r({dataId:e,parent:n(i),index:t})})),p.concat([{path:d,parent:s,index:c}])}({dataId:r}))}(a.masterPage,o),u=function(r,a){return e.reduce(a,function(a,i){var o=i.path,s=i.index,u=i.parent,c=e.get(r,o);if(c.link){var d=e.get(r,"data.document_data."+c.link.replace("#","")),p=Object.assign({data:c},{linkItem:d,index:s,parent:u});t.includes(d.type)?a.pagesRelatedItems[n(d.pageId)]=p:a.nonPagesRelatedItems[c.id]=p}return a},{pagesRelatedItems:{},nonPagesRelatedItems:{}})}(a.masterPage,s),c=u.pagesRelatedItems,d=u.nonPagesRelatedItems;return e.forEach(c,function(t,a){e.set(r.pages,[a,"content","menus",o,t.data.id],e.omit(t,"data.items")),e.unset(i,t.data.id),t.data.link&&e.unset(i,n(t.data.link))}),r.menus[o]={data:e.omit(e.get(i,o),"items"),items:d},e(d).keys().forEach(function(t){e.unset(i,t)}),r},{menus:{},pages:{}})},deserialize:function(t){var r=Object.keys(t.menus).reduce(function(n,r){return Object.assign(n,i({},r,e.merge({},i({},r,t.menus[r].data),t.menus[r].items,e.reduce(t.pages,function(t,n){return e.assign(t,n.content.menus[r])},{}))))},{});return{pagesData:{masterPage:{data:{document_data:e(r).keys().reduce(function(t,a){return Object.assign(t,function(t){var r=t.menuType,a=t.menuItems;function o(t){return e(a).filter(["parent",t]).orderBy(function(e){return e.index}).value()}var s=a[r],u=o(r).reduce(function(e,t){return Object.assign(e,t.linkItem?i({},t.linkItem.id,t.linkItem):{},i({},t.data.id,Object.assign(t.data,{items:[]})),i({},r,Object.assign(e[r],{items:e[r].items.concat("#"+t.data.id)})))},i({},r,Object.assign(s,{items:[]})));return e.flatMap(s.items.map(n).map(o)).reduce(function(t,n){return Object.assign(t,n.linkItem?i({},n.linkItem.id,n.linkItem):{},i({},n.data.id,n.data),i({},n.parent,Object.assign(t[n.parent],{items:e.get(t[n.parent],"items",[]).concat("#"+n.data.id)})))},u)}({menuType:a,menuItems:r[a]}))},{})}}}}},getEncryptedPaths:function(t){return e(t.menus).keys().map(function(e){return"menus."+e}).concat(e(t.pages).keys().map(function(e){return"pages."+e+".content.menus"}).value()).value()}}}.apply(t,r))||(e.exports=a)},1490:function(e,t,n){var r,a;r=[n(0)],void 0===(a=function(e){"use strict";return{encode:function(t){return e.flow([JSON.stringify,encodeURIComponent,unescape,btoa])(t)},decode:function(t){return e.flow([atob,escape,decodeURIComponent,JSON.parse])(t)}}}.apply(t,r))||(e.exports=a)}})});
//# sourceMappingURL=localSiteSerializer.min.js.map